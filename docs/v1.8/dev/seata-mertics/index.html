<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-v1.8 docs-doc-page docs-doc-id-dev/seata-mertics" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Metrics Design | Apache Seata</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://seata.apache.org/img/seata_logo.png"><meta data-rh="true" name="twitter:image" content="https://seata.apache.org/img/seata_logo.png"><meta data-rh="true" property="og:url" content="https://seata.apache.org/docs/v1.8/dev/seata-mertics"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v1.8"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.8"><meta data-rh="true" name="docsearch:version" content="v1.8"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.8"><meta data-rh="true" property="og:title" content="Metrics Design | Apache Seata"><meta data-rh="true" name="description" content="Seata Metrics"><meta data-rh="true" property="og:description" content="Seata Metrics"><meta data-rh="true" name="keywords" content="Seata,Metrics"><link data-rh="true" rel="icon" href="/img/seata_logo_small.jpeg"><link data-rh="true" rel="canonical" href="https://seata.apache.org/docs/v1.8/dev/seata-mertics"><link data-rh="true" rel="alternate" href="https://seata.apache.org/docs/v1.8/dev/seata-mertics" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://seata.apache.org/zh-cn/docs/v1.8/dev/seata-mertics" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://seata.apache.org/docs/v1.8/dev/seata-mertics" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ICHFIJRDZF-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Seata RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Seata Atom Feed">


<link rel="search" type="application/opensearchdescription+xml" title="Apache Seata" href="/opensearch.xml">


<meta name="aes-config" content="pid=xux-opensource&amp;user_type=101&amp;uid=&amp;username=&amp;dim10=seata">
<script src="/js/gtag.js" async></script>
<script src="/js/hm.js" async></script>
<script src="/js/aplus_v2.js" id="beacon-aplus" exparams="clog=o&amp;aplus&amp;sidx=aplusSidx&amp;ckx=aplusCkx" defer="defer"></script>
<script src="/js/tracker.js" defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.1f151b5e.css">
<script src="/assets/js/runtime~main.689c2b6c.js" defer="defer"></script>
<script src="/assets/js/main.b05e832d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/seata_logo.png" alt="Seata Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/seata_logo.png" alt="Seata Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/">Home</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="/overview/what-is-seata" href="/docs/v1.8/overview/what-is-seata">v1.8</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/dev/seata-mertics">Next Version</a></li><li><a class="dropdown__link" href="/docs/dev/seata-mertics">v2.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/v1.8/dev/seata-mertics">v1.8</a></li><li><a class="dropdown__link" href="/docs/v1.7/dev/seata-mertics">v1.7</a></li><li><a class="dropdown__link" href="/docs/v1.6/dev/seata-mertics">v1.6</a></li><li><a class="dropdown__link" href="/docs/v1.5/dev/seata-mertics">v1.5</a></li><li><a class="dropdown__link" href="/docs/v1.4/dev/seata-mertics">v1.4</a></li><li><a class="dropdown__link" href="/docs/v1.3/dev/seata-mertics">v1.3</a></li><li><a class="dropdown__link" href="/docs/v1.2/dev/seata-mertics">v1.2</a></li><li><a class="dropdown__link" href="/docs/v1.1/dev/seata-mertics">v1.1</a></li><li><a class="dropdown__link" href="/docs/v1.0/dev/seata-mertics">v1.0</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/v1.8/developers/contributor-guide/new-contributor-guide_dev">Developers</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/users">Users</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/unversioned/download/seata-server">Download</a><a class="navbar__item navbar__link" href="/solution">Solution</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Designer</a><ul class="dropdown__menu"><li><a href="/saga-designer" class="dropdown__link" target="_blank">Saga Designer</a></li><li><a href="/saga-designer-legacy" class="dropdown__link" target="_blank">Saga Designer (Legacy)</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>En</a><ul class="dropdown__menu"><li><a href="/docs/v1.8/dev/seata-mertics" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">En</a></li><li><a href="/zh-cn/docs/v1.8/dev/seata-mertics" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中</a></li></ul></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Overview</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/overview/what-is-seata">What Is Seata?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/overview/history">History</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/overview/terminology">Terminology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/overview/faq">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">User Doc</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/user/quickstart">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/user/configurations">Seata Parameter Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/mode/at">Transaction Mode</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/txgroup/transaction-group">Transactions Grouping</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/configuration/">Configuration Center</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/registry/">Registry Center</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/user/api">Api Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/user/microservice">Microservice Framework Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/user/ormframework">ORM Framework Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/user/datasource">Data Source support</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/sqlreference/sql-restrictions">SQL Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/apm/skywalking">APM</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/performance">Testing Report</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/user/appendix/global-transaction-status">Appendix</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Developer Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/dev/mode/at-mode">Transaction Mode</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/dev/domain/overviewDomainModel">Domain Model</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/v1.8/dev/seata-mertics">Metrics Design</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Ops Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/ops/upgrade">Version Upgrade Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1.8/ops/multi-configuration-isolation">Multi-configuration Isolation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/v1.8/ops/deploy-guide-beginner">Deploy</a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Seata<!-- --> <b>v1.8</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/dev/seata-mertics">latest version</a></b> (<!-- -->v2.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Developer Guide</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Metrics Design</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v1.8</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Metrics Design</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="metrics">Metrics<a href="#metrics" class="hash-link" aria-label="Direct link to Metrics" title="Direct link to Metrics">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="design-philosophy">Design Philosophy<a href="#design-philosophy" class="hash-link" aria-label="Direct link to Design Philosophy" title="Direct link to Design Philosophy">​</a></h4>
<ol>
<li>Seata, as an integrated data consistency framework, will minimize the use of third-party dependencies to reduce the risk of conflicts in the Metrics module.</li>
<li>The Metrics module will strive for higher measurement performance and lower resource overhead, minimizing side effects when enabled.</li>
<li>When configuring, whether Metrics is activated and how data are published depend on the corresponding configuration; enabling configuration will automatically activate Metrics and publish measurement data to <a href="https://github.com/prometheus" target="_blank" rel="noopener noreferrer">Prometheus</a>.</li>
<li>Using Service Provider Interface (SPI) for loading extensions instead of Spring.</li>
<li>Initially, only core Transaction-related metrics will be published, and all other operational metrics will be gradually improved based on community needs.</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="module-description">Module Description<a href="#module-description" class="hash-link" aria-label="Direct link to Module Description" title="Direct link to Module Description">​</a></h4>
<p>It consists of two core API modules, <code>seata-metrics-api</code> and <code>seata-metrics-core</code>, as well as N implementation modules such as <code>seata-metrics-registry-compact</code> and <code>seata-metrics-exporter-prometheus</code>:</p>
<ul>
<li>seata-metrics-api Module</li>
</ul>
<p>This module is the core of Metrics and is part of the Seata infrastructure, referenced by TC, TM, and RM. It <strong>does not contain any specific implementation code</strong>, but it only includes interface definitions, including:</p>
<ol>
<li>Meter class interfaces: <code>Gauge</code>, <code>Counter</code>, <code>Timer</code>, etc.</li>
<li>Registry container interface <code>Registry</code></li>
<li>Measurement publishing interface <code>Publisher</code></li>
</ol>
<blockquote>
<p>Note: There are many existing implementations of Metrics in the open-source community, such as</p>
<ol>
<li><a href="https://github.com/Netflix/spectator" target="_blank" rel="noopener noreferrer">Netflix-Spectator</a></li>
<li><a href="https://github.com/dropwizard/metrics" target="_blank" rel="noopener noreferrer">Dropwizard-Metrics</a></li>
<li><a href="https://github.com/dubbo/dubbo-metrics" target="_blank" rel="noopener noreferrer">Dubbo-Metrics</a>
Some of them are lightweight and agile, while others are heavy and powerful. Since they are also &quot;implementations&quot;, they will not be included in <code>seata-metrics-api</code> to avoid implementation binding.</li>
</ol>
</blockquote>
<ul>
<li>seata-metrics-core Module</li>
</ul>
<p>This core module of Metrics organizes (loads) one Registry and N Exporters based on configuration.</p>
<ul>
<li>seata-metrics-registry-compact Module</li>
</ul>
<p>This is the default (built-in) Registry implementation we provide.Instead of using other open-source Metrics libraries, it provides lightweight implementations of four types of Meters:</p>
<ul>
<li>seata-metrics-exporter-prometheus Module</li>
</ul>
<p>This is the default Metrics implementation we provide. Without using other open-source Metrics implementations, it provides lightweight implementations of three types of Meters:</p>
<table><thead><tr><th>Meter Type</th><th>Description</th></tr></thead><tbody><tr><td>Gauge</td><td>Single latest value meter</td></tr><tr><td>Counter</td><td>Single accumulating meter, can increase or decrease</td></tr><tr><td>Summary</td><td>Multi-measurement output counter, outputs <code>total</code>, <code>count</code>, and <code>tps</code> (total per second) with no units</td></tr><tr><td>Timer</td><td>Multi-measurement output timer, outputs <code>total</code>, <code>count</code>, <code>max</code>, and <code>average</code>, supports accumulation in microseconds</td></tr></tbody></table>
<blockquote>
<p>Note:</p>
<ol>
<li>More complex meters such as Histogram may be added in the future. Histogram is a type of meter that locally aggregates 75th, 90th, 95th, 98th, 99th, 99.9th, etc., and is suitable for certain scenarios but requires more memory.</li>
<li>All meters inherit from Meter, and after executing the measure() method, all meters will generate 1 or N normalized Measurement results.</li>
</ol>
</blockquote>
<p>It also implements an in-memory Registry and Prometheus Exporter to synchronize measurement data with Prometheus.</p>
<blockquote>
<p>Note: Different monitoring systems have different ways of collecting measurement data. For example, Zabbix supports pushing with zabbix-agent, while Prometheus recommends using prometheus-server <a href="https://prometheus.io/docs/practices/pushing/" target="_blank" rel="noopener noreferrer">pulling</a>. Similarly, data exchange protocols are also different, so adaptation is often needed one by one.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use">How to Use<a href="#how-to-use" class="hash-link" aria-label="Direct link to How to Use" title="Direct link to How to Use">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="add-configuration">Add Configuration<a href="#add-configuration" class="hash-link" aria-label="Direct link to Add Configuration" title="Direct link to Add Configuration">​</a></h5>
<p>If you need to enable TC Metrics, you need to add configuration items in its configuration file:</p>
<p>Take file.conf for example</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">## metrics settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metrics {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  registryType = &quot;compact&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # multi exporters use comma divided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  exporterList = &quot;prometheus&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  exporterPrometheusPort = 9898</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Or You can use application.yaml for versions above 1.5.0</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">seata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metrics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">registryType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> compact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">exporterList</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">exporterPrometheusPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9898</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Or You can also use a third-party configuration center such as nacos, apollo, etc.</p>
<p><a href="https://github.com/apache/incubator-seata/tree/develop/script/config-center" target="_blank" rel="noopener noreferrer">Please refer to here</a> to upload the seata metrics configuration items to the corresponding configuration center, or open the corresponding configuration center console for manually adding.</p>
<div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">metrics.enabled=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metrics.registryType=compact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metrics.exporterList=prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metrics.exporterPrometheusPort=9898</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After starting TC, you can get the text format data of Metrics on <code>http://tc-server-ip:9898/metrics</code>.</p>
<blockquote>
<p>Tips: Port <code>9898</code> is used by default, and the list of ports registered by Prometheus <a href="https://github.com/prometheus/prometheus/wiki/Default-port-allocations" target="_blank" rel="noopener noreferrer">can be visited here</a>. If you want to change this port, you can use <code>metrics.exporter.prometheus.port</code> to modify the configuration.</p>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="download-and-start-prometheus">Download and start Prometheus<a href="#download-and-start-prometheus" class="hash-link" aria-label="Direct link to Download and start Prometheus" title="Direct link to Download and start Prometheus">  ​</a></h5>
<p>After the download is complete, modify the Prometheus configuration file <code>prometheus.yml</code>, and add an item to grab Seata&#x27;s measurement data in <code>scrape_configs</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">scrape_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;prometheus&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># metrics_path defaults to &#x27;/metrics&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># scheme defaults to &#x27;http&#x27;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;localhost:9090&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;seata&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># metrics_path defaults to &#x27;/metrics&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># scheme defaults to &#x27;http&#x27;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;tc-server-ip:9898&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="view-data-output">View data output<a href="#view-data-output" class="hash-link" aria-label="Direct link to View data output" title="Direct link to View data output">​</a></h5>
<p>It is recommended to combine the configuration [Grafana] (<a href="https://prometheus.io/docs/visualization/grafana/" target="_blank" rel="noopener noreferrer">https://prometheus.io/docs/visualization/grafana/</a>) to obtain better query results. The initial Metrics exported by Seata include:</p>
<ul>
<li>TC :</li>
</ul>
<table><thead><tr><th>Metrics</th><th>Description</th></tr></thead><tbody><tr><td>seata.transaction(role=tc,meter=counter,status=active/committed/rollback)</td><td>Total number of currently active/committed/rollback transactions</td></tr><tr><td>seata.transaction(role=tc, meter=summary, statistic=count, status=committed/rollback)</td><td>The number of transactions committed/rolled back in the current cycle</td></tr><tr><td>seata.transaction(role=tc,meter=summary,statistic=tps,status=committed/rollback)</td><td>Transaction TPS(transaction per second) committed/rolled back in the current cycle</td></tr><tr><td>seata.transaction(role=tc, meter=timer, statistic=total, status=committed/rollback)</td><td>The sum of time-consuming transactions committed/rolled back in the current cycle</td></tr><tr><td>seata.transaction(role=tc, meter=timer, statistic=count, status=committed/rollback)</td><td>The number of transactions committed/rolled back in the current cycle</td></tr><tr><td>seata.transaction(role=tc, meter=timer, statistic=average, status=committed/rollback)</td><td>The average transaction time spent on committing/rolling back in the current cycle</td></tr><tr><td>seata.transaction(role=tc, meter=timer, statistic=max, status=committed/rollback)</td><td>The maximum time-consuming transaction committed/rolled back in the current cycle</td></tr></tbody></table>
<p>Hint: the values of seata.transaction(role=tc, meter=summary, statistic=count, status=committed/rollback) and seata.transaction(role=tc, meter=timer, statistic=count, status=committed/rollback) may be the same, but they are derived from two different metrics.</p>
<p>-TM:</p>
<p>TM will be implemented later, including:
seata.transaction(role=tm,name={GlobalTransactionalName},meter=counter,status=active/committed/rollback) : Use GlobalTransactionalName as the dimension to distinguish the status of different Transactional.</p>
<p>-RM:</p>
<p>RM will be implemented later, including:
seata.transaction(role=rm, name={BranchTransactionalName}, mode=at/mt, meter=counter, status=active/committed/rollback): Use BranchTransactionalName as the dimension and AT/MT dimension to distinguish the transactional status of different branches.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-extend">How to extend<a href="#how-to-extend" class="hash-link" aria-label="Direct link to How to extend" title="Direct link to How to extend">​</a></h4>
<p>If there are any of the following situations:</p>
<ol>
<li>You do not use Prometheus as the operation and maintenance monitoring system, but you want to integrate Seata&#x27;s Metrics data into Dashboard;</li>
<li>You need more complex and powerful metric types, which already exist in other Metrics implementation libraries, and hope to integrate these third-party dependencies for direct use;</li>
<li>You need to change the Measurement output of the default Metric, such as adding a <code>min</code> or <code>sd</code> (variance) to the Timer;</li>
<li>...</li>
</ol>
<p>Then you need to extend the implementation of Metrics by yourself, please create a new module project such as <code>seata-metrics-xxxx</code>, after that:</p>
<ul>
<li>For 1: you need to implement a new Exporter;</li>
<li>For 2: You can change the default Registry implementation and return the third-party Meter implementation;</li>
<li>For 3: You can modify the implementation of the corresponding Meter, including the Measurement list returned by the <code>measure()</code> method.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/incubator-seata-website/blob/docusaurus/i18n/en/docusaurus-plugin-content-docs/version-v1.8/dev/seata-mertics.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/v1.8/dev/domain/tc"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Transaction Coordinator(TC)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/v1.8/ops/upgrade"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Version Upgrade Guide</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#metrics" class="table-of-contents__link toc-highlight">Metrics</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://incubator.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/apache/incubator.svg" alt="Apache Incubator Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/apache/incubator.svg" alt="Apache Incubator Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">
                  <div class="fs-12">
                    <div class="center-div">
                      <span>Apache Seata (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</span>
                    </div>
                    <br>
                    <div class="center-div">
                      <span>Copyright © 2023-2024, The Apache Software Foundation Apache Seata, Seata, Apache, Apache Incubator, the Apache feather, the Apache Incubator logo and the Apache Seata project logo are either registered trademarks or trademarks of the Apache Software Foundation.</span>
                      <br>
                    </div>
                    <br>
                  </div>
                  </div></div></div></footer></div>
</body>
</html>