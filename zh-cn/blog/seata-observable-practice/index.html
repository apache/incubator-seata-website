<!doctype html>
<html lang="zh-CN" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Seata的可观测实践 | Apache Seata</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://seata.apache.org/zh-cn/img/seata_logo.png"><meta data-rh="true" name="twitter:image" content="https://seata.apache.org/zh-cn/img/seata_logo.png"><meta data-rh="true" property="og:url" content="https://seata.apache.org/zh-cn/blog/seata-observable-practice"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" property="og:locale:alternate" content="en_US"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Seata的可观测实践 | Apache Seata"><meta data-rh="true" name="description" content="本文介绍Seata在可观测领域的探索和实践"><meta data-rh="true" property="og:description" content="本文介绍Seata在可观测领域的探索和实践"><meta data-rh="true" name="keywords" content="Seata、分布式事务、数据一致性、微服务、可观测"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-06-25T00:00:00.000Z"><link data-rh="true" rel="icon" href="/zh-cn/img/seata_logo_small.jpeg"><link data-rh="true" rel="canonical" href="https://seata.apache.org/zh-cn/blog/seata-observable-practice"><link data-rh="true" rel="alternate" href="https://seata.apache.org/blog/seata-observable-practice" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://seata.apache.org/zh-cn/blog/seata-observable-practice" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://seata.apache.org/blog/seata-observable-practice" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ICHFIJRDZF-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/zh-cn/blog/rss.xml" title="Apache Seata RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-cn/blog/atom.xml" title="Apache Seata Atom Feed">


<link rel="search" type="application/opensearchdescription+xml" title="Apache Seata" href="/zh-cn/opensearch.xml">


<meta name="aes-config" content="pid=xux-opensource&amp;user_type=101&amp;uid=&amp;username=&amp;dim10=seata"><link rel="stylesheet" href="/zh-cn/assets/css/styles.9644caf2.css">
<script src="/zh-cn/assets/js/runtime~main.8bb8fbaf.js" defer="defer"></script>
<script src="/zh-cn/assets/js/main.d72a880a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-cn/"><div class="navbar__logo"><img src="/zh-cn/img/seata_logo.png" alt="Seata Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh-cn/img/seata_logo.png" alt="Seata Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh-cn/">首页</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="/overview/what-is-seata" href="/zh-cn/docs/overview/what-is-seata">v2.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-cn/docs/next/overview/what-is-seata">预览版</a></li><li><a class="dropdown__link" href="/zh-cn/docs/overview/what-is-seata">v2.1</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v2.0/overview/what-is-seata">v2.0</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.8/overview/what-is-seata">v1.8</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.7/overview/what-is-seata">v1.7</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.6/overview/what-is-seata">v1.6</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.5/overview/what-is-seata">v1.5</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.4/overview/what-is-seata">v1.4</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.3/overview/what-is-seata">v1.3</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.2/overview/what-is-seata">v1.2</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.1/overview/what-is-seata">v1.1</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v1.0/overview/what-is-seata">v1.0</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-cn/docs/developers/contributor-guide/new-contributor-guide_dev">开发者</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-cn/blog">博客</a><a class="navbar__item navbar__link" href="/zh-cn/users">用户</a><a class="navbar__item navbar__link" href="/zh-cn/community">社区</a><a class="navbar__item navbar__link" href="/zh-cn/unversioned/download/seata-server">下载</a><a class="navbar__item navbar__link" href="/zh-cn/solution">解决方案</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">设计器</a><ul class="dropdown__menu"><li><a href="/zh-cn/saga-designer" class="dropdown__link" target="_blank">Saga 设计器</a></li><li><a href="/zh-cn/saga-designer-legacy" class="dropdown__link" target="_blank">Saga 设计器（旧版）</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中</a><ul class="dropdown__menu"><li><a href="/blog/seata-observable-practice" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">En</a></li><li><a href="/zh-cn/blog/seata-observable-practice" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">中</a></li></ul></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">所有文章</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-rpc-multi-protocol01">Seata的RPC通信源码分析01：传输篇</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-rpc-multi-protocol02">Seata的RPC通信源码分析02：协议篇（多版本协议）</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/how-to-write-unit-tests">如何在seata中编写测试用例</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/explore-seata-journey">探索 Seata 项目开源开发之旅</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-raft-detailed-explanation">Seata-Raft 存储模式详解及入门</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-connect-data-and-application">Seata：连接数据与应用</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/zh-cn/blog/seata-observable-practice">Seata的可观测实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-go-1.2.0">生产环境可用的 seata-go 1.2.0 来了！！！</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/iscas2023">6大课题现已开放挑选 | 欢迎报名 Seata 开源之夏</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-1.6.0">Seata 1.6.0 重磅发布，大幅提升性能</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-1.5.2">Seata 1.5.2 重磅发布，支持xid负载均衡</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-tcc-fence">阿里 Seata 新版本终于解决了 TCC 模式的幂等、悬挂和空回滚问题</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-tcc">深度剖析 Seata TCC 模式（一）</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-at-lock">详解 Seata AT 模式事务隔离级别与全局锁设计</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-snowflake-explain">关于新版雪花算法的答疑</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-UUID-generator">Seata基于改良版雪花算法的分布式UUID生成器分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-feature-undo-log-compress">Seata新特性支持 -- undo_log压缩</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-dsproxy-deadlock">ConcurrentHashMap导致的Seata死锁问题</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-client-start-analysis-02">Seata应用侧启动过程剖析——注册中心与配置中心模块</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-client-start-analysis-01">Seata应用侧启动过程剖析——RM &amp; TM如何与TC建立连接</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/integrate-seata-tcc-mode-with-spring-cloud">Spring Cloud集成Seata分布式事务-TCC模式</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-config-manager">Seata配置管理原理解析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-golang-communication-mode">seata-golang 通信模型详解</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-datasource-proxy">Seata数据源代理解析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-sourcecode-client-bootstrap">分布式事务Seata源码-Client端启动流程</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-at-demo-in-mac">Mac下的Seata Demo环境搭建（AT模式）</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-rpc-refactor">Seata RPC 模块的重构之路</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-sourcecode-server-bootstrap">分布式事务Seata源码-Server端启动流程</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-xa-introduce">分布式事务如何实现？深入解读 Seata 的 XA 模式</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-quick-start">Seata 极简入门</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-ha-practice">Seata 高可用部署实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-config-modular">Seata config 模块源码分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-dubbo-transmit-xid">源码分析Seata-XID传递 Dubbo篇</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-tcc-modular">Seata tcc 模块源码分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-community-meetup-hangzhou-ready">Seata Community Meetup·杭州站</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-core-modular">Seata core 模块源码分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-spring-boot-aop-aspectj">通过AOP动态创建/关闭Seata分布式事务</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-dynamic-config-and-dynamic-disable">Seata 动态配置订阅与降级实现原理</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-config-center">Seata 配置中心实现原理</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-nacos-docker">Docker部署Seata与Nacos整合</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-nacos-analysis">Seata分布式事务启用Nacos做配置中心</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-meetup-hangzhou">Seata Community Meetup·杭州站</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-mybatisplus-analysis">透过源码解决SeataAT模式整合Mybatis-Plus失去MP特性的问题</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/springboot-dubbo-mybatisplus-seata">SpringBoot+Dubbo+MybatisPlus整合seata分布式事务</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-at-mode-start-rm-tm">Seata 客户端需要同时启动 RM 和 TM 吗？</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-at-mode-start">Seata AT 模式启动源码分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/design-more-flexable-application-by-saga">基于 Seata Saga 设计更有弹性的金融应用</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-at-tcc-saga">分布式事务 Seata 及其三种模式详解</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-at-mode-design">分布式事务中间件 Seata 的设计原理</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-go-server">Seata分布式Go Server正式开源-TaaS设计简介</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/how-to-support-spring-cloud">Fescar 与 Spring Cloud 集成源码深度剖析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/integrate-seata-with-spring-cloud">Seata（Fescar）分布式事务 整合 Spring Cloud</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-java-client">分布式事务之Seata-Client原理及流程详解</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-java-server">深度剖析一站式分布式事务方案Seata-Server</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/tcc-mode-applicable-scenario-analysis">TCC适用模型与适用场景分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/tcc-mode-design-principle">TCC 理论及设计实现指南介绍</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/quick-start-use-seata-and-dubbo-services">如何使用Seata保证Dubbo微服务间的一致性</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/seata-analysis-simple">Fescar分布式事务原理解析探秘</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/manual-transaction-mode">MT 模式</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="本文介绍Seata在可观测领域的探索和实践"><meta itemprop="keywords" content="Seata、分布式事务、数据一致性、微服务、可观测"><header><h1 class="title_f1Hy" itemprop="headline">Seata的可观测实践</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-06-25T00:00:00.000Z" itemprop="datePublished">2023年6月25日</time> · <!-- -->阅读需 12 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">刘戎-Seata</span></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="seata简介">Seata简介<a href="#seata简介" class="hash-link" aria-label="Seata简介的直接链接" title="Seata简介的直接链接">​</a></h2>
<p>Seata的前身是阿里巴巴集团内大规模使用保证分布式事务一致性的中间件，Seata是其开源产品，由社区维护。在介绍Seata前，先与大家讨论下我们业务发展过程中经常遇到的一些问题场景。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="业务场景">业务场景<a href="#业务场景" class="hash-link" aria-label="业务场景的直接链接" title="业务场景的直接链接">​</a></h3>
<p>我们业务在发展的过程中，基本上都是从一个简单的应用，逐渐过渡到规模庞大、业务复杂的应用。这些复杂的场景难免遇到分布式事务管理问题，Seata的出现正是解决这些分布式场景下的事务管理问题。介绍下其中几个经典的场景：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="场景一分库分表场景下的分布式事务">场景一：分库分表场景下的分布式事务<a href="#场景一分库分表场景下的分布式事务" class="hash-link" aria-label="场景一：分库分表场景下的分布式事务的直接链接" title="场景一：分库分表场景下的分布式事务的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-分库分表场景下的分布式事务-ee0eff8cf24e6e3e997b0b040c56690e.png" width="1200" height="624" class="img_ev3q">
起初我们的业务规模小、轻量化，单一数据库就能保障我们的数据链路。但随着业务规模不断扩大、业务不断复杂化，通常单一数据库在容量、性能上会遭遇瓶颈。通常的解决方案是向分库、分表的架构演进。此时，即引入了<strong>分库分表场景下</strong>的分布式事务场景。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="场景二跨服务场景下的分布式事务">场景二：跨服务场景下的分布式事务<a href="#场景二跨服务场景下的分布式事务" class="hash-link" aria-label="场景二：跨服务场景下的分布式事务的直接链接" title="场景二：跨服务场景下的分布式事务的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-跨服务场景下的分布式事务-ccc122e03531914d0945e82137912655.png" width="1200" height="647" class="img_ev3q">
降低单体应用复杂度的方案：应用微服务化拆分。拆分后，我们的产品由多个功能各异的微服务组件构成，每个微服务都使用独立的数据库资源。在涉及到跨服务调用的数据一致性场景时，就引入了<strong>跨服务场景下</strong>的分布式事务。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="seata架构">Seata架构<a href="#seata架构" class="hash-link" aria-label="Seata架构的直接链接" title="Seata架构的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-Seata架构-d45c1d1bf146b044c4f1b7f85ba3beb8.png" width="1534" height="908" class="img_ev3q">
其核心组件主要如下：</p>
<ul>
<li><strong>Transaction Coordinator（TC）</strong></li>
</ul>
<p>事务协调器，维护全局事务的运行状态，负责协调并驱动全局事务的提交或回滚。</p>
<ul>
<li><strong>Transaction Manager（TM）</strong></li>
</ul>
<p>控制全局事务的边界，负责开启一个全局事务，并最终发起全局提交或全局回滚的决议，TM定义全局事务的边界。</p>
<ul>
<li><strong>Resource Manager（RM）</strong></li>
</ul>
<p>控制分支事务，负责分支注册、状态汇报，并接收事务协调器的指令，驱动分支（本地）事务的提交和回滚。RM负责定义分支事务的边界和行为。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="seata的可观测实践">Seata的可观测实践<a href="#seata的可观测实践" class="hash-link" aria-label="Seata的可观测实践的直接链接" title="Seata的可观测实践的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="为什么需要可观测">为什么需要可观测？<a href="#为什么需要可观测" class="hash-link" aria-label="为什么需要可观测？的直接链接" title="为什么需要可观测？的直接链接">​</a></h3>
<ul>
<li><strong>分布式事务消息链路较复杂</strong></li>
</ul>
<p>Seata在解决了用户易用性和分布式事务一致性这些问题的同时，需要多次TC与TM、RM之间的交互，尤其当微服务的链路变复杂时，Seata的交互链路也会呈正相关性增加。这种情况下，其实我们就需要引入可观测的能力来观察、分析事物链路。</p>
<ul>
<li><strong>异常链路、故障排查难定位，性能优化无从下手</strong></li>
</ul>
<p>在排查Seata的异常事务链路时，传统的方法需要看日志，这样检索起来比较麻烦。在引入可观测能力后，帮助我们直观的分析链路，快速定位问题；为优化耗时的事务链路提供依据。</p>
<ul>
<li><strong>可视化、数据可量化</strong></li>
</ul>
<p>可视化能力可让用户对事务执行情况有直观的感受；借助可量化的数据，可帮助用户评估资源消耗、规划预算。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="可观测能力概览">可观测能力概览<a href="#可观测能力概览" class="hash-link" aria-label="可观测能力概览的直接链接" title="可观测能力概览的直接链接">​</a></h3>
<table><thead><tr><th><strong>可观测维度</strong></th><th><strong>seata期望的能力</strong></th><th><strong>技术选型参考</strong></th></tr></thead><tbody><tr><td>Metrics</td><td>功能层面：可按业务分组隔离，采集事务总量、耗时等重要指标</td><td></td></tr><tr><td>性能层面：高度量性能，插件按需加载</td><td></td><td></td></tr><tr><td>架构层面：减少第三方依赖，服务端、客户端能够采用统一的架构，减少技术复杂度</td><td></td><td></td></tr><tr><td>兼容性层面：至少兼容Prometheus生态</td><td>Prometheus：指标存储和查询等领域有着业界领先的地位</td><td></td></tr><tr><td>OpenTelemetry：可观测数据采集和规范的事实标准。但自身并不负责数据的存储，展示和分析</td><td></td><td></td></tr><tr><td>Tracing</td><td>功能层面：全链路追踪分布式事务生命周期，反应分布式事务执行性能消耗</td><td></td></tr><tr><td>易用性方面：对使用seata的用户而言简单易接入</td><td>SkyWalking：利用Java的Agent探针技术，效率高，简单易用。</td><td></td></tr><tr><td>Logging</td><td>功能层面：记录服务端、客户端全部生命周期信息</td><td></td></tr><tr><td>易用性层面：能根据XID快速匹配全局事务对应链路日志</td><td>Alibaba Cloud Service</td><td></td></tr><tr><td>ELK</td><td></td><td></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metrics维度">Metrics维度<a href="#metrics维度" class="hash-link" aria-label="Metrics维度的直接链接" title="Metrics维度的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="设计思路">设计思路<a href="#设计思路" class="hash-link" aria-label="设计思路的直接链接" title="设计思路的直接链接">​</a></h4>
<ol>
<li>Seata作为一个被集成的数据一致性框架，Metrics模块将尽可能少的使用第三方依赖以降低发生冲突的风险</li>
<li>Metrics模块将竭力争取更高的度量性能和更低的资源开销，尽可能降低开启后带来的副作用</li>
<li>配置时，Metrics是否激活、数据如何发布，取决于对应的配置；开启配置则自动启用，并默认将度量数据通过prometheusexporter的形式发布</li>
<li>不使用Spring，使用SPI(Service Provider Interface)加载扩展</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="模块设计">模块设计<a href="#模块设计" class="hash-link" aria-label="模块设计的直接链接" title="模块设计的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="图片 1.png" src="/zh-cn/assets/images/metrics-模块设计-44acf0482c9b8fbb5f6ec11a1423440c.png" width="1296" height="746" class="img_ev3q"></p>
<ul>
<li>seata-metrics-core：Metrics核心模块，根据配置组织（加载）1个Registry和N个Exporter；</li>
<li>seata-metrics-api：定义了Meter指标接口，Registry指标注册中心接口；</li>
<li>seata-metrics-exporter-prometheus：内置的prometheus-exporter实现；</li>
<li>seata-metrics-registry-compact：内置的Registry实现，并轻量级实现了Gauge、Counter、Summay、Timer指标；</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="metrics模块工作流">metrics模块工作流<a href="#metrics模块工作流" class="hash-link" aria-label="metrics模块工作流的直接链接" title="metrics模块工作流的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="图片 1.png" src="/zh-cn/assets/images/metrics-模块工作流-cf55ed8598aa42930fb5d0c58399463d.png" width="1534" height="964" class="img_ev3q">
上图是metrics模块的工作流，其工作流程如下：</p>
<ol>
<li>利用SPI机制，根据配置加载Exporter和Registry的实现类；</li>
<li>基于消息订阅与通知机制，监听所  有全局事务的状态变更事件，并publish到EventBus；</li>
<li>事件订阅者消费事件，并将生成的metrics写入Registry；</li>
<li>监控系统（如prometheus）从Exporter中拉取数据。</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tc核心指标">TC核心指标<a href="#tc核心指标" class="hash-link" aria-label="TC核心指标的直接链接" title="TC核心指标的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-TC核心指标-7de91006545ab3e5518b6889456a8302.png" width="1746" height="1072" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tm核心指标">TM核心指标<a href="#tm核心指标" class="hash-link" aria-label="TM核心指标的直接链接" title="TM核心指标的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-TM核心指标-8ef5523801c632ae5af707ade30576b5.png" width="2308" height="1094" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rm核心指标">RM核心指标<a href="#rm核心指标" class="hash-link" aria-label="RM核心指标的直接链接" title="RM核心指标的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-RM核心指标-30ac5fe4e5c6e0d0727a3d28bf94ec82.png" width="2122" height="1580" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="大盘展示">大盘展示<a href="#大盘展示" class="hash-link" aria-label="大盘展示的直接链接" title="大盘展示的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="lQLPJxZhZlqESU3NBpjNBp6w8zYK6VbMgzYCoKVrWEDWAA_1694_1688.png" src="/zh-cn/assets/images/metrics-大盘展示-1f6d2bdf7f5bc02f56244b361764ee7c.png" width="1694" height="1688" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tracing维度">Tracing维度<a href="#tracing维度" class="hash-link" aria-label="Tracing维度的直接链接" title="Tracing维度的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="seata为什么需要tracing">Seata为什么需要tracing？<a href="#seata为什么需要tracing" class="hash-link" aria-label="Seata为什么需要tracing？的直接链接" title="Seata为什么需要tracing？的直接链接">​</a></h4>
<ol>
<li>对业务侧而言，引入Seata后，对业务性能会带来多大损耗？主要时间消耗在什么地方？如何针对性的优化业务逻辑？这些都是未知的。</li>
<li>Seata的所有消息记录都通过日志持久化落盘，但对不了解Seata的用户而言，日志非常不友好。能否通过接入Tracing，提升事务链路排查效率？</li>
<li>对于新手用户，可通过Tracing记录，快速了解seata的工作原理，降低seata使用门槛。</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="seata的tracing解决方案">Seata的tracing解决方案<a href="#seata的tracing解决方案" class="hash-link" aria-label="Seata的tracing解决方案的直接链接" title="Seata的tracing解决方案的直接链接">​</a></h4>
<ul>
<li>Seata在自定义的RPC消息协议中定义了Header信息；</li>
<li>SkyWalking拦截指定的RPC消息，并注入tracing相关的span信息；</li>
<li>以RPC消息的发出&amp;接收为临界点，定义了span的生命周期范围。</li>
</ul>
<p>基于上述的方式，Seata实现了事务全链路的tracing，具体接入可参考<a href="/zh-cn/docs/user/apm/skywalking/">为[Seata应用 | Seata-server]接入Skywalking</a>。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tracing效果">tracing效果<a href="#tracing效果" class="hash-link" aria-label="tracing效果的直接链接" title="tracing效果的直接链接">​</a></h4>
<ul>
<li>基于的demo场景：</li>
</ul>
<ol>
<li>用户请求交易服务</li>
<li>交易服务锁定库存</li>
<li>交易服务创建账单</li>
<li>账单服务进行扣款</li>
</ol>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-tracing效果-业务逻辑图-92ed3a1bb1fc62135d8d02d1a21951fb.png" width="865" height="489" class="img_ev3q"></p>
<ul>
<li>GlobalCommit成功的事务链路（事例）</li>
</ul>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-tracing效果-tracing链1-e4e8b13e4b0a74c76631560a66973d2a.png" width="1080" height="1788" class="img_ev3q">
<img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-tracing效果-tracing链2-d5a816ec8b49b6ca95309eeda8470825.png" width="1080" height="2647" class="img_ev3q">
<img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-tracing效果-tracing链3-c50deab1728f8e61946a26d7d1b49da8.png" width="1080" height="1466" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging维度">Logging维度<a href="#logging维度" class="hash-link" aria-label="Logging维度的直接链接" title="Logging维度的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="设计思路-1">设计思路<a href="#设计思路-1" class="hash-link" aria-label="设计思路的直接链接" title="设计思路的直接链接">​</a></h4>
<p><img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-logging设计思路-c90fe7b88cab305e7b3c918df2cba8b6.png" width="1434" height="454" class="img_ev3q">
Logging这一块其实承担的是可观测这几个维度当中的兜底角色。放在最底层的，其实就是我们日志格式的设计，只有好日志格式，我们才能对它进行更好的采集、模块化的存储和展示。在其之上，是日志的采集、存储、监控、告警、数据可视化，这些模块更多的是有现成的工具，比如阿里的SLS日志服务、还有ELK的一套技术栈，我们更多是将开销成本、接入复杂度、生态繁荣度等作为考量。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="日志格式设计">日志格式设计<a href="#日志格式设计" class="hash-link" aria-label="日志格式设计的直接链接" title="日志格式设计的直接链接">​</a></h4>
<p>这里拿Seata-Server的一个日志格式作为案例：
<img decoding="async" loading="lazy" alt="image.png" src="/zh-cn/assets/images/metrics-logging日志效果-049f409856a4895fe3d27d7930e028f8.png" width="1342" height="364" class="img_ev3q"></p>
<ul>
<li>线程池规范命名：当线程池、线程比较多时，规范的线程命名能将无序执行的线程执行次序清晰展示。</li>
<li>方法全类名可追溯：快速定位到具体的代码块。</li>
<li>重点运行时信息透出：重点突出关键日志，不关键的日志不打印，减少日志冗余。</li>
<li>消息格式可扩展：通过扩展消息类的输出格式，减少日志的代码修改量。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结展望">总结&amp;展望<a href="#总结展望" class="hash-link" aria-label="总结&amp;展望的直接链接" title="总结&amp;展望的直接链接">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="metrics">Metrics<a href="#metrics" class="hash-link" aria-label="Metrics的直接链接" title="Metrics的直接链接">​</a></h4>
<p>总结：基本实现分布式事务的可量化、可观测。
展望：更细粒度的指标、更广阔的生态兼容。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tracing">Tracing<a href="#tracing" class="hash-link" aria-label="Tracing的直接链接" title="Tracing的直接链接">​</a></h4>
<p>总结：分布式事务全链路的可追溯。
展望：根据xid追溯事务链路，异常链路根因快速定位。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Logging的直接链接" title="Logging的直接链接">​</a></h4>
<p>总结：结构化的日志格式。
展望：日志可观测体系演进。</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col margin-top--sm"><a href="https://github.com/apache/incubator-seata-website/blob/docusaurus/i18n/zh-cn/docusaurus-plugin-content-blog/seata-observable-practice.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-cn/blog/seata-connect-data-and-application"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">Seata：连接数据与应用</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-cn/blog/seata-go-1.2.0"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">生产环境可用的 seata-go 1.2.0 来了！！！</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#seata简介" class="table-of-contents__link toc-highlight">Seata简介</a><ul><li><a href="#业务场景" class="table-of-contents__link toc-highlight">业务场景</a></li><li><a href="#seata架构" class="table-of-contents__link toc-highlight">Seata架构</a></li></ul></li><li><a href="#seata的可观测实践" class="table-of-contents__link toc-highlight">Seata的可观测实践</a><ul><li><a href="#为什么需要可观测" class="table-of-contents__link toc-highlight">为什么需要可观测？</a></li><li><a href="#可观测能力概览" class="table-of-contents__link toc-highlight">可观测能力概览</a></li><li><a href="#metrics维度" class="table-of-contents__link toc-highlight">Metrics维度</a></li><li><a href="#tracing维度" class="table-of-contents__link toc-highlight">Tracing维度</a></li><li><a href="#logging维度" class="table-of-contents__link toc-highlight">Logging维度</a></li></ul></li><li><a href="#总结展望" class="table-of-contents__link toc-highlight">总结&amp;展望</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://incubator.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/zh-cn/img/apache/incubator.svg" alt="Apache Incubator Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh-cn/img/apache/incubator.svg" alt="Apache Incubator Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">
                  <div class="fs-12">
                    <div class="center-div">
                      <span>Apache Seata (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</span>
                    </div>
                    <br>
                    <div class="center-div">
                      <span>Copyright © 2023-2024, The Apache Software Foundation Apache Seata, Seata, Apache, Apache Incubator, the Apache feather, the Apache Incubator logo and the Apache Seata project logo are either registered trademarks or trademarks of the Apache Software Foundation.</span>
                      <br>
                    </div>
                    <br>
                  </div>
                  </div></div></div></footer></div>
</body>
</html>