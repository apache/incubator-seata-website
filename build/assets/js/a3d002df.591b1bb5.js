"use strict";(self.webpackChunkseata_website=self.webpackChunkseata_website||[]).push([[69963],{36112:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var r=t(74848),a=t(28453);const s={title:"FAQ",keywords:["Seata"],description:"Seata FAQ."},i="FAQ",o={id:"overview/faq",title:"FAQ",description:"Seata FAQ.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-v2.2/overview/faq.md",sourceDirName:"overview",slug:"/overview/faq",permalink:"/docs/overview/faq",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/incubator-seata-website/blob/docusaurus/i18n/en/docusaurus-plugin-content-docs/version-v2.2/overview/faq.md",tags:[],version:"v2.2",frontMatter:{title:"FAQ",keywords:["Seata"],description:"Seata FAQ."},sidebar:"docs",previous:{title:"Terminology",permalink:"/docs/overview/terminology"},next:{title:"Quick Start",permalink:"/docs/user/quickstart"}},c={},l=[];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)("a",{href:"#1",target:"_self",children:"1.Can Seata be used in a production environment?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#2",target:"_self",children:"2.Dose Seata support high availability ?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#3",target:"_self",children:"3.What is the use of the record of undo log table log status = 1 ?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#4",target:"_self",children:"4.How to use the Seata framework to ensure transaction isolation?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#5",target:"_self",children:"5.When Failed to roll back dirty data, what shall I do ?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#6",target:"_self",children:'6.Why the global transaction state is not "begin" when a branch transaction is registered ?'}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#7",target:"_self",children:"7.When Nacos is used as the Seata configuration center, the project startup error report cannot find the service. How to check and deal with it ?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#8",target:"_self",children:"8.When Eureka is the registry and TC is highly available, how to overwrite Eureka properties at the TC end?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#9",target:"_self",children:"9.java.lang.NoSuchMethodError: com.fasterxml.jackson.databind.jsontype.TypeSerializer.typeId(Ljava/lang/Object;Lcom/fasterxml/jackson/core/JsonToken;)?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#10",target:"_self",children:"10. Why didn't my mybatis operation return auto-generated ID? "}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)("a",{href:"#11",target:"_self",children:["11.I can't find this package",":io",".seata.codec.protobuf.generated,and cant't run seata server?"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#12",target:"_self",children:"12.How TC uses mysql8?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#13",target:"_self",children:"13.Support multiple primary keys?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#14",target:"_self",children:"14.How to solve the error reported by HikariDataSource?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#15",target:"_self",children:"15.Can I write the configuration directly to application.properties without using the conf type configuration file?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#16",target:"_self",children:"16.How to package seata-server after modifying the source code?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#17",target:"_self",children:"17.What RPC frameworks does seata support now?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#18",target:"_self",children:"18. java.lang.NoSuchMethodError: com.alibaba.druid.sql.ast.statement\n.SQLSelect.getFirstQueueBlockLcom/alibaba/druid/sql/ast/statement/SQLSelectQueryBlock;"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#19",target:"_self",children:"19. NoSuchMethodError in apache-dubbo 2.7.0?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#20",target:"_self",children:"20.What are the precautions for using AT mode?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#21",target:"_self",children:"21.Why will the win system have one more empty line for the properties when configured with synchronization script?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#22",target:"_self",children:"22.What to note for the AT mode and Spring @Transactional annotation hyphenation?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#23",target:"_self",children:"23.Spring boot 1.5.x appear the Jackson related NoClassDefFoundException?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#24",target:"_self",children:"24.SpringCloud/HTTP xid cannot transmit?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#25",target:"_self",children:"25.undo_log cannot be deleted after using the mybatis plus dynamic data source component?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#26",target:"_self",children:"26.Could not found global transaction xid = %s, may be has finished."}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#27",target:"_self",children:"27.Why does TC reported this error: An exceptionCaught() event was fired, and it reached at the tail of the pipeline. It usually means the last handler in the pipeline did not handle the exception?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#28",target:"_self",children:"28.The database enables automatic update timestamp, which makes dirty data unable to be rolled back?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#29",target:"_self",children:"29.timeoutrollching occurs before the global transaction timeout?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#30",target:"_self",children:"30.What database and table splitting solutions does Seata support at this stage?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#31",target:"_self",children:"31.What are the restrictions on Seata's address registered with the registry?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#32",target:"_self",children:"32.seata-server cannot be started due to Unrecognized VM option 'CMSParallelRemarkEnabled'\nError: Could not create the Java Virtual Machine.\nError: A fatal exception has occurred. Program will exit.?"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#33",target:"_self",children:"33. Why does the java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer error occur when the client's JDK version is 1.8 when compiling and running ? "}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("a",{href:"#34",target:"_self",children:'34. Why does the error "pk contains illegal character!" occur? '}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"1",children:"Q: 1.Can Seata be used in a production environment?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nSince version 0.4.2,it is supported in production environment,Users who are using seata are welcome to complete this issue together:",(0,r.jsx)(n.a,{href:"https://github.com/apache/incubator-seata/issues/1246",children:"who's using Seata"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"2",children:"Q: 2.Dose Seata support high availability ?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nsupported from version 0.6, tc USES db mode to share global transaction session information, and the registry USES non-file seata-supported third-party registries"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"3",children:"Q: 3.What is the use of the record of undo log table log status = 1 ?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario:"})," after A branch transaction A registers TC, A global transaction rollback occurs before A local transaction commits"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Consequence:"})," global transaction rollback succeeds, a resource is occupied, resulting in resource suspension problem"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Anti-suspension measures:"})," when a rolls back and finds that the rollback undo has not been inserted, an undo record with log_status=1 is inserted. When a local transaction (business write operation SQL and corresponding undo are a local transaction) is committed, it fails due to the unique key conflict of the undo table."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"4",children:"Q: 4.How to use the Seata framework to ensure transaction isolation?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nSince seata phase 1 local transactions have been committed, enhanced isolation is needed to prevent other transactions from dirty reads and dirty writes."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Dirty read Select statement with for update, proxy method with @GlobalLock+@Transactional or @GlobalTransaction"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Dirty write You must use @GlobalTransactional"}),"\n",(0,r.jsx)(n.p,{children:"note\uff1aIf the interface of the business you are querying does not use the @GlobalTransactional annotation, which means there is no need for distributed transactions on the method, you can annotate the @globallock+@Transactional annotation on the method and add a for update statement to the query.\nIf your query interface has the @GlobalTransactional annotation on the outer edge of the transactional link, you can simply add a for update statement to your query. The reason for designing this annotation is that before it is available, distributed transactions need to query the committed data, but the business does not need distributed transactions.\nUsing the @GlobalTransactional annotation adds some unnecessary additional RPC overhead such as begin returning xid, commit transaction, etc. GlobalLock simplifies the RPC process for higher performance."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"5",children:"Q: 5.When Failed to roll back dirty data, what shall I do ?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The dirty data needs to be processed manually, and the data can be corrected according to the log prompt, or the corresponding undo can be deleted (the FailureHandler can be customized for email notification or other purposes)."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'This option is not recommended when "undo" mirror validation is turned off during rollback.'}),"\n",(0,r.jsx)(n.p,{children:"node\uff1aIt is recommended to isolate the dirty data in advance"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"6",children:'Q: 6.Why the global transaction state is not "begin" when a branch transaction is registered ?'}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"abnormal\uff1a"})," Could not register branch into global session xid = status = Rollbacked\uff08Two phase state and Rollbacking, AsyncCommitting, etc\uff09 while expecting Begin"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"describe\uff1a"}),' When a branch transaction is registered, the global transaction status must be a one-phase state "begin", and registration other than "begin" is not allowed. It belongs to the normal processing at the seata framework level, and users can solve it from their own business level.']}),"\n",(0,r.jsx)(n.p,{children:"This exception can occur in the following situations (you can continue to add)."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"The branch transaction is asynchronous. The global transaction is not aware of its progress. The global transaction has entered phase 2 before the asynchronous branch comes to register."}),"\n",(0,r.jsx)(n.li,{children:"Service a rpc service b timed out (dubbo, feign, etc. timeout by default for 1 second), a throws an exception to tm, tm informs tc to roll back, but b still receives the request (network delay or rpc framework retry), and then registers at tc Global transaction was found to be rolling back."}),"\n",(0,r.jsx)(n.li,{children:"Tc is aware of the global transaction timeout (@GlobalTransactional (timeoutMills = default 60 seconds)), actively changes the state and notifies each branch transaction to rollback when a new branch transaction is registered."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"7",children:"Q: 7.When Nacos is used as the Seata configuration center, the project startup error report cannot find the service. How to check and deal with it ?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nabnormal\uff1aio.seata.common.exception.FrameworkException: can not register RM,err",":can"," not connect to services-server."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check the nacos configuration list to see if the seata configuration has been imported successfully."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check the list of nacos services to see if serverAddr has been registered successfully."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'Check the namespace, registry.nacos.namespace and config.nacos.namespace in the client\'s registry.conf and enter the nacos namespace ID. The default is "". The server and client correspond to the namespace.\nIt is public and is a reserved control of nacos. If you need to create your own namespace, it is better not to use the same name as public, and use a name that has specific semantics in an actual business scenario.'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"For the list of services on nacos, the IP address corresponding to serverAddr address should be the IP address specified for seata startup, such as: sh seata-server.sh-p 8091-h 122.51.204.197-m file."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check to see if the seata/conf/nacos-config.txt, transaction group service.vgroupMapping.trade_group=default"}),"\n",(0,r.jsx)(n.p,{children:"configuration is the same as the project group configuration name."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Telnet IP port view ports are open as well as firewall status."}),"\n",(0,r.jsx)(n.p,{children:'note\uff1a1.Version 080 starts the specified IP problem, the exception "Exception in thread "main" java.lang.RuntimeException: java.net.BindException: Cannot assign request address", please upgrade to version 081 or above.\nThe project USES jdk13 and starts with'}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-verilog",children:"   Error: Could not create the Java Virtual Machine\n   Error: A fatal exception has occurred. Program will exit.\n"})}),"\n",(0,r.jsx)(n.p,{children:"If the environment is sh, replace the last paragraph in the script\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'        exec "$JAVACMD" $JAVA_OPTS -server -Xmx2048m -Xms2048m -Xmn1024m -Xss512k -XX:SurvivorRatio=10 -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=256m -XX:\nMaxDirectMemorySize=1024m -XX:-OmitStackTraceInFastThrow -XX:-UseAdaptiveSizePolicy -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath="$BASEDIR"/logs\n/java_heapdump.hprof -XX:+DisableExplicitGC -XX:+CMSParallelRemarkEnabled -XX:+\nUseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=75 -verbose:gc -Dio.netty.leakDetectionLevel=advanced \\\n          -classpath "$CLASSPATH" \\\n          -Dapp.name="seata-server" \\\n          -Dapp.pid="$$" \\\n          -Dapp.repo="$REPO" \\\n          -Dapp.home="$BASEDIR" \\\n          -Dbasedir="$BASEDIR" \\\n          io.seata.server.Server \\\n          "$@"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"8",children:"Q: 8.When Eureka is the registry and TC is highly available, how to overwrite Eureka properties at the TC end?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nAdd the eureka-client.properties file in the seata\\conf directory and add the Eureka properties to be overwritten.\nFor example, to overwrite eureka.instance.lease-renewal-interval-in-seconds and eureka.instance.lease-expiration-duration-in-seconds, add the following:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"eureka.lease.renewalInterval=1\neureka.lease.duration=2\n"})}),"\n",(0,r.jsx)(n.p,{children:"The attribute prefix is eureka, and the subsequent attribute names can refer to the class com.netflix.appinfo.PropertyBasedInstanceConfigConstants. You can also study the seata-discovery-eureka project of the discovery module in the seata source code."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"9",children:"Q: 9.What's the reason of java.lang.NoSuchMethodError: com.fasterxml.jackson.databind.jsontype.TypeSerializer.typeId(Ljava/lang/Object;Lcom/fasterxml/jackson/core/JsonToken;) ?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nwhen the undolog serialization is configured as Jackson, the Jackson version needs to be 2.9.9+"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"10",children:"Q: 10. Why didn't my mybatis operation return auto-generated ID? "}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nplan1.You should update the configuraton of ",(0,r.jsx)(n.code,{children:"mybatis"}),": set annotation ",(0,r.jsx)(n.code,{children:'@Options(useGeneratedKeys = true, keyProperty = "id")'})," or set the value of useGeneratedKeys and keyProperty in ",(0,r.jsx)(n.code,{children:"mybatis"})," xml configuraton",(0,r.jsx)(n.br,{}),"\n","plan2.Delete the id field of the undo_log table"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)("h3",{id:"11",children:["Q: 11.I can't find this package",":io",".seata.codec.protobuf.generated,and cant't run seata server?"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A:"}),"\nYou can execute this command: ",(0,r.jsx)(n.code,{children:"./mvnw clean install -DskipTests=true"})," (Mac,Linux) or ",(0,r.jsx)(n.code,{children:"mvnw.cmd clean install -DskipTests=true"}),", (Win)",(0,r.jsx)(n.a,{href:"https://github.com/apache/incubator-seata/issues/2438",children:"reference issues/2438"}),",These codes have been removed in version 0.8.1."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"12",children:"Q: 12.How TC uses mysql8?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Modify the driver configuration ",(0,r.jsx)(n.code,{children:"store.db.driver-class-name"})," of ",(0,r.jsx)(n.code,{children:"file.conf"}),";"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Delete mysql5 driver and add mysql8 driver under lib directory"}),"\n",(0,r.jsxs)(n.p,{children:["ps: The same is true for Oracle; ",(0,r.jsx)(n.code,{children:"1.2.0"})," supports MySQL driver multi version isolation without adding drivers"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"13",children:"Q: 13.Support multiple primary keys?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.p,{children:"For the time being, only MySQL is supported. For other types of databases, it is recommended to create a column of self incremented ID primary keys first, and change the original composite primary keys to unique keys to avoid the problem."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"14",children:"Q: 14.How to solve the error reported by HikariDataSource?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-markdown",children:"**Error1**:ClassCastException: com.sun.proxy.$Proxy153 cannot be cast to com.zaxxer.hikari.HikariDataSource\n**Reason**:Instance type conversion error during automatic proxy, injected with $Proxy153 instance, not HikariDataSource's own or subclass instance.\n**Solution**: The Seata automatic proxy data source function uses JDK proxy to proxy DataSource. The generated proxy class extends Proxy implements DataSource can be changed by the receiver to DataSource receive implementation.\n1.1.0 will support both JDK proxy and cglib, and cglib will also be able to switch to solve the problem.\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"15",children:"Q: 15.Can I write the configuration directly to application.properties without using the conf type configuration file?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:["At present, ",(0,r.jsx)(n.code,{children:"seata-all"})," needs to use conf type ",(0,r.jsx)(n.code,{children:"conf"})," files, and ",(0,r.jsx)(n.code,{children:"properties"})," and ",(0,r.jsx)(n.code,{children:"yml"})," type files will be supported later. At present, you can rely on ",(0,r.jsx)(n.code,{children:"seata-spring-boot-starter"})," in the project, and then write the configuration item to the ",(0,r.jsx)(n.code,{children:"application.properties"})," so that the conf type file is not used."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"16",children:"Q: 16.How to package seata-server after modifying the source code?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Delete the ",(0,r.jsx)(n.code,{children:"bin"}),",",(0,r.jsx)(n.code,{children:"conf"}),",and ",(0,r.jsx)(n.code,{children:"lib"})," directories of the ",(0,r.jsx)(n.code,{children:"distribution"})," module."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"./mvnw clean install -DskipTests=true(Mac,Linux)"})," OR ",(0,r.jsx)(n.code,{children:"mvnw.cmd clean install -DskipTests=true(Win) -P release-seata"}),"\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["Unzip the corresponding compressed package in the target directory of the ",(0,r.jsx)(n.code,{children:"distribution"})," module."]}),"\n",(0,r.jsxs)(n.li,{children:["Packaging commands after seata-1.5 (the latest development branch), ",(0,r.jsx)(n.code,{children:"mvn -Prelease-seata -Dmaven.test.skip=true clean install -U"})]}),"\n",(0,r.jsxs)(n.li,{children:["If you are on macOS platform with ARM architecture, please use: ",(0,r.jsx)(n.code,{children:"mvn -Prelease-seata -Dmaven.test.skip=true clean install -U -P arrch64"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"17",children:"Q: 17.What RPC frameworks does seata support now?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"Dubbo, Spring Cloud, Motan, gRPC , sofa-RPC , EDAS-HSF and bRPC\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"18",children:"Q: 18. java.lang.NoSuchMethodError: com.alibaba.druid.sql.ast.statement\n.SQLSelect.getFirstQueueBlockLcom/alibaba/druid/sql/ast/statement/SQLSelectQueryBlock;"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A\uff1a"})}),"\n",(0,r.jsxs)(n.p,{children:["The dependent version of ",(0,r.jsx)(n.code,{children:"druid"})," needs to be upgraded to version ",(0,r.jsx)(n.code,{children:"1.1.12 +"}),", and the default dependent version in Seata is ",(0,r.jsx)(n.code,{children:"1.1.12"})," (provided)."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"19",children:"Q: 19.NoSuchMethodError in apache-dubbo 2.7.0\uff1f"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:["When apache-dubbo loads the filter, it will load the filter of Alibaba Dubbo together, and it will be found in ",(0,r.jsx)(n.code,{children:"com.alibaba.dubbo.rpc.invoker"})," in version ",(0,r.jsx)(n.code,{children:"2.7.0"}),"(",(0,r.jsx)(n.code,{children:"Result invoke(org.apache.dubbo.rpc.Invocation invocation) throws RpcException;"}),"), Misuse of ",(0,r.jsx)(n.code,{children:"org.apache.dubbo.rpc.invocation"})," to enter parameters (fixed in",(0,r.jsx)(n.code,{children:" 2.7.1"}),"), resulting in ",(0,r.jsx)(n.code,{children:"java.lang.NoSuchMethodError: com.alibaba.dubbo.rpc.Invoker.invoke(Lcom/alibaba/dubbo/rpc/Invocation;)Lcom/alibaba/dubbo/rpc/Result;"})]}),"\n",(0,r.jsxs)(n.p,{children:["So please upgrade ",(0,r.jsx)(n.code,{children:"dubbo"})," to ",(0,r.jsx)(n.code,{children:"2.7.1"})," or above to ensure compatibility. It is ",(0,r.jsx)(n.code,{children:"alibaba-dubbo"})," and can be used safely. ",(0,r.jsx)(n.code,{children:"alibaba-dubbo"})," does not contain ",(0,r.jsx)(n.code,{children:"apache-dubbo"})," packages."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"20",children:"Q: 20.What are the precautions for using AT mode?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Proxy data sources must be used. There are three forms of proxy data sources:"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["When relying on ",(0,r.jsx)(n.code,{children:"seata-spring-boot-starter"}),", the data source is automatically proxied without additional processing."]}),"\n",(0,r.jsxs)(n.li,{children:["When relying on ",(0,r.jsx)(n.code,{children:"seata-all"}),", use @EnableAutoDatasourceProxy (since 1.1.0) annotation. JDK proxy or cglib proxy can be selected as annotation parameters."]}),"\n",(0,r.jsxs)(n.li,{children:["When relying on ",(0,r.jsx)(n.code,{children:"seata-all"}),", you can also manually wrap the DataSource with DatasourceProxy."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["To configure ",(0,r.jsx)(n.code,{children:"GlobalTransactionScanner"}),", you need to configure it manually when using ",(0,r.jsx)(n.code,{children:"seata-all"}),", and no additional processing is required when using ",(0,r.jsx)(n.code,{children:"seata-spring-boot-starter"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"The business table must contain a single column primary key. If there is a composite primary key, please refer to question 13."}),"\n",(0,r.jsx)(n.li,{children:"Each business library must contain undo_ log table. If it is used in conjunction with the sub-treasury and split-table component, can be sub-treasury but cannot be split-table"}),"\n",(0,r.jsxs)(n.li,{children:["Transactions across microservice links need support for the corresponding RPC framework, which is currently supported in seata-all: ",(0,r.jsx)(n.code,{children:"Apache Dubbo, Alibaba Dubbo, sofa-RPC, Motan, gRpc, httpClient"}),", for support from Spring Cloud, please kindly cite ",(0,r.jsx)(n.code,{children:"spring-cloud-alibaba-seata"}),". Other self research framework, asynchronous model, message consumption transaction model please support itself in combination with the API."]}),"\n",(0,r.jsx)(n.li,{children:"The databases currently supported by AT mode are: MySQL, Oracle, PostgreSQL, and TIDB."}),"\n",(0,r.jsx)(n.li,{children:"When opening distributed transactions with annotations, provider may not annotate transactions if the default service provider side joins transactions on the consumer side.However, provider similarly requires corresponding dependencies and configurations, and only annotations may be omitted."}),"\n",(0,r.jsx)(n.li,{children:"On opening the distributed transactions with annotations, if transactions are required to roll back, the exception must be thrown to the originator of the transaction, perceived by the @GlobalTransactional annotation of the transaction originator.Provide directly throws exceptions or defines error code to throw exceptions again as judged by consumer."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"21",children:"Q: 21.Why will the win system have one more empty line for the properties when configured with synchronization script?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:["It is currently known why the configuration will have a ",(0,r.jsx)(n.code,{children:"\\r"}),", presumably because this file you write in win, so there are permutations to ",(0,r.jsx)(n.code,{children:"\\r\\n"}),", and then you execute it with git bash (this can be considered Linux) to recognize ",(0,r.jsx)(n.code,{children:"\\n"})," permutations, so there is more ",(0,r.jsx)(n.code,{children:"\\r"})]}),"\n",(0,r.jsx)(n.p,{children:"The solution is currently twofold:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:'sed -i ""s/\\r//"" config.txt'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"vim"})," into the text with the command ",(0,r.jsx)(n.code,{children:"set fileformat = unix"})," (the pro test is available)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"22",children:"Q: 22.What to note for the AT mode and Spring @Transactional annotation hyphenation?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"@Transactional"})," can be coupled with ",(0,r.jsx)(n.code,{children:"DataSourceTransactionManager"})," and ",(0,r.jsx)(n.code,{children:"JTATransactionManager"})," to represent local transactions and XA distributed transactions, respectively. Common to everyone is the combination with local affairs."]}),"\n",(0,r.jsxs)(n.p,{children:["When combined with local transactions",(0,r.jsx)(n.code,{children:"@Transactial"})," and ",(0,r.jsx)(n.code,{children:"@GlobalTransactional"})," are hyphenated,",(0,r.jsx)(n.code,{children:"@Transactial"})," can only be located in the same method hierarchy annotated at ",(0,r.jsx)(n.code,{children:"@GlobalTransaction"})," or within the inner layer of ",(0,r.jsx)(n.code,{children:"@GlobalTransaction"})," annotation methods."]}),"\n",(0,r.jsxs)(n.p,{children:["Here the concept of distributed transactions is larger than local transactions, annotating ",(0,r.jsx)(n.code,{children:"@Transactional"})," outside results in a distributed transaction empty submission, a global transaction being submitted when the ",(0,r.jsx)(n.code,{children:"@Transactional"})," corresponding connection submission is declared or the XID of the global transaction is absent."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"23",children:"Q: 23.Spring boot 1.5.x appear the Jackson related NoClassDefFoundException?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Caused by: java.lang.NoClassDefFoundError: Could not initialize class com.fasterxml.jackson.databind.ObjectMapper\n"})}),"\n",(0,r.jsxs)(n.p,{children:["It is currently found that too low a version of Jackson that was originally introduced in spring boot version 1.5.x, can cause Seata to rely on Jackson to find new features, Seata requires that the Jackson version 2.9.9+, but the use of the Jackson version 2.9.9 + version can cause the Jackson API used in spring boot to not find, and is a problem with forward compatibility in the Jackson itself. Therefore, it is recommended that you switch Seata's serialization to non Jackson serialization, such as kryo, with the configuration term ",(0,r.jsx)(n.code,{children:'client.undo.logSerialization = "kryo"'})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"24",children:"Q: 24.SpringCloud/HTTP xid cannot transmit?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["If it is the springcloud application, make sure you have introduced ",(0,r.jsx)(n.code,{children:"spring-cloud-starter-alibaba-seata"})," as a dependency."]}),"\n",(0,r.jsxs)(n.li,{children:["If the xid hasn't been accepted yet, please confirm whether you have implemented the ",(0,r.jsx)(n.code,{children:"WebMvcConfigurer"}),"; if you have, please add ",(0,r.jsx)(n.code,{children:"org.apache.seata.integration.http.TransactionPropagationInterceptor.SeataHandlerInterceptor"})," to your interception chain. You can refer to how ",(0,r.jsx)(n.code,{children:"org.apache.seata.integration.http.SeataWebMvcConfigurer"})," is implemented."]}),"\n",(0,r.jsxs)(n.li,{children:["If it isn't a SpringCloud application, you can use ",(0,r.jsx)(n.code,{children:"org.apache.seata.integration.http.DefaultHttpExecutor#getInstance "}),"to invoke http when necessary, or refer to its implementation and encapsulate the httpclient to transfer xid by yourself."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"25",children:"Q: 25.undo_log cannot be deleted after using the mybatis plus dynamic data source component?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"dynamic-datasource-spring-boot-starter"})," component will automatically use ",(0,r.jsx)(n.code,{children:"DataSourceProxy"})," to wrap the ",(0,r.jsx)(n.code,{children:"DataSource"})," after opening Seata. Therefore, the following methods are required to maintain compatibility:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["If you imported ",(0,r.jsx)(n.code,{children:"seata-all"}),", please do not use @EnableAutoDatasourceProxy annotation"]}),"\n",(0,r.jsxs)(n.li,{children:["If you imported ",(0,r.jsx)(n.code,{children:"seata-spring-boot-starter"}),", please turn off the automatic agent"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"seata:\n  enable-auto-data-source-proxy: false\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"26",children:"Q: 26. Could not found global transaction xid = %s, may be has finished."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.p,{children:"Examples\uff1a"}),"\n",(0,r.jsx)(n.p,{children:"@GlobalTransactional(timeout=60000)\npublic void A\uff08\uff09{"}),"\n",(0,r.jsx)(n.p,{children:"call remoting B();//Remote call B service\n\u200b local DB operation;"}),"\n",(0,r.jsx)(n.p,{children:"}"}),"\n",(0,r.jsx)(n.p,{children:"public void B() {"}),"\n",(0,r.jsx)(n.p,{children:"}"}),"\n",(0,r.jsx)(n.p,{children:"Possible causes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The overall execution time of service A exceeds 60000ms, causing the global transaction to initiate a global rollback. At this time, method A or B continues to execute DB operation, verify the global transaction status, and find that the global transaction has been rolled back."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"When service B executes the readTimeout beyond its setting, it returns an exception to a and throws the exception, causing the global transaction to be rolled back. At this time, when service B performs the DB operation, it verifies the global transaction status and finds that the global transaction has been rolled back."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Impact: in this case, the data will be rolled back to the initial state of the data before the execution of method A. from the perspective of data consistency, the data is consistent as a whole."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"27",children:"Q: 27. Why does TC reported this error: An exceptionCaught() event was fired, and it reached at the tail of the pipeline. It usually means the last handler in the pipeline did not handle the exception?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.p,{children:"This error is caused by the connection established by an abnormal Seata client (such as accessing the Seata server port through HTTP, port scanning of ECS, etc.). This connection does not send registration information and is considered a useless connection. This exception can be ignored."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"28",children:"Q: 28. The database enables automatic update timestamp, which makes dirty data unable to be rolled back?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.p,{children:"Due to the business submission, after Seata records the current image, the database updates the timestamp again, resulting in the failure of image verification."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution 1:"})," Turn off automatic timestamp update of the database. The timestamp update of data, such as modification and creation time, is maintained at the code level. For example, MybatisPlus can automatically fill in."]}),"\n",(0,r.jsx)(n.p,{children:"**Solution 2:**UPDATE statement don't put the fields that haven't been updated into the update statement."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"29",children:"Q: 29. timeoutrollching occurs before the global transaction timeout?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.p,{children:"It is recommended that the time zone of TC database be inconsistent with the time zone of DB database."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"30",children:"Q: 30. What database and table splitting solutions does Seata support at this stage?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.p,{children:"Only shardingsphere is supported at this stage. With regard to the compatibility of sub-treasury and split-table with Seata, Seata supports a sub database and sub table scheme by requiring the sub-treasury and split-table framework team to provide an integrated compatibility scheme, rather than Seata. At present, Seata is communicating with each sub-treasury and split-table framework team to discuss the integration compatibility scheme."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"31",children:"Q: 31. What are the restrictions on Seata's address registered with the registry?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:["The Seata registry cannot register addresses of 0.0.0.0 or 127.0.0.1. When the address is automatically registered as the above address, you can start the parameter ",(0,r.jsx)(n.code,{children:"-h"})," or the container environment variable ",(0,r.jsx)(n.code,{children:"SEATA_IP"}),". When the and business services are on different networks, the registered address can be specified as ",(0,r.jsx)(n.code,{children:"NAT_IP"})," or ",(0,r.jsx)(n.code,{children:"public network IP"}),", but it is necessary to ensure that the health inspection activities of the registration center are unobstructed."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"32",children:"Q: 32. seata-server cannot be started due to Unrecognized VM option 'CMSParallelRemarkEnabled'\nError: Could not create the Java Virtual Machine.\nError: A fatal exception has occurred. Program will exit.?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsx)(n.p,{children:"This is due to the use of a higher version of JDK. The higher version of JDK cancels the CMS processor and replaces it with ZGC."}),"\n",(0,r.jsx)(n.p,{children:"There are two solutions. Choose one of them:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Downgrade JDK version"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Delete the JDK command of CMS in the startup script of Seata"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"33",children:"Q\uff1a33. Why does the java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer error occur when the client's JDK version is 1.8 when compiling and running\uff1f "}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A:"})}),"\n",(0,r.jsxs)(n.p,{children:["This is because the seata source code was compiled and then the local seata dependency package was overwritten. JDK 11 was used when compiling the seata source code. In JDK 11, the ",(0,r.jsx)(n.code,{children:"flip()"})," method was rewritten, resulting in incompatibility."]}),"\n",(0,r.jsx)(n.p,{children:"Solution:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Make sure that the JDK version is 1.8 when compiling seata source code to avoid compatibility issues"}),"\n",(0,r.jsx)(n.li,{children:"If you have compiled the source code of seata with JDK 11, please delete all packages under the io.seata path in the local maven repository. Then recompile your project and let the project re-pull the seata dependency package of the central warehouse"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("h3",{id:"34",children:'Q: 34. Why does the error "pk contains illegal character!" occur?'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check if the primary key contains a comma."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var r=t(96540);const a={},s=r.createContext(a);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);